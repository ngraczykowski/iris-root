spark:
  master: ${S8_SPARK_MASTER:local[6]}
  app-name: ${S8_SPARK_APP_NAME:main-pipeline}
  config:
    'spark.executor.memory': ${S8_SPARK_EXECUTOR_MEMORY:512m}
    'spark.driver.memory': ${S8_SPARK_DRIVER_MEMORY:4g}
    'spark.jars.packages': io.delta:delta-core_2.12:0.8.0
    'spark.sql.extensions': io.delta.sql.DeltaSparkSessionExtension
    'spark.sql.catalog.spark_catalog': org.apache.spark.sql.delta.catalog.DeltaCatalog
  #    'spark.local.dir': '/app/tmp'
  #    'spark.executor.extraJavaOptions': '-Djava.io.tmpdir=/app/tmp'
  #    'spark.driver.extraJavaOptions': '-Djava.io.tmpdir=/app/tmp'  

  min-available-memory-ratio: ${S8_MIN_AVAILABLE_MEMORY_RATIO:1.0}
  min-available-memory-over-required: ${S8_MIN_AVAILABLE_MEMORY_OVER_REQUIRED:1g}

pipeline:
  name: hsbc-build-360
  result_dir: notebooks-outputs/
  notebooks_path: ${MOAPOV_NOTEBOOKS_PATH}
  cs_notebooks_path: ${CS_NOTEBOOKS_PATH}

  steps:

    - 0.2-moapov-get-spark-context
    # - 1.0-raw-to-standardized
    # - 1.1-data-quality-check-on-standardized
    # - 2.0-standardized-to-cleansed
    # - 2.1-data-quality-check-on-cleansed
    # - 3.0-cleansed-to-application-agent-input
    - 3.2.0-run-name-agent
    - 3.2.1-run-dob-agent
    - 3.2.2-run-gender-agent
    - 3.2.3-run-national-id-agent
    - 3.2.4-run-nationality-country-agent
    - 4.0-merge-agent-input-output
    - 4.1-apply-policy-steps-generate-solution