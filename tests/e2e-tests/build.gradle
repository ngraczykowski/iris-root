plugins {
  id 'java'
}

group = 'com.silenteight.iris.tests'

java {
  toolchain {
    languageVersion = JavaLanguageVersion.of(11)
  }
}

repositories {
  mavenCentral()
}

dependencies {
  testImplementation group: 'com.aventstack', name: 'extentreports', version: '5.0.9'
  testImplementation group: 'com.fasterxml.jackson.core', name: 'jackson-databind',
      version: '2.13.2.2'
  testImplementation group: 'com.fasterxml.jackson.dataformat', name: 'jackson-dataformat-csv',
      version: '2.13.2'
  testImplementation group: 'org.apache.commons', name: 'commons-text', version: '1.9'
  testImplementation group: 'io.cucumber', name: 'cucumber-jvm-deps', version: '1.0.6'
  testImplementation group: 'io.cucumber', name: 'cucumber-junit', version: '7.3.4'
  testImplementation group: 'io.rest-assured', name: 'rest-assured', version: '5.0.1'
  testImplementation group: 'io.cucumber', name: 'cucumber-java', version: '7.3.4'
  testImplementation group: 'junit', name: 'junit', version: '4.13.2'
  testImplementation group: 'org.awaitility', name: 'awaitility', version: '4.2.0'
//  testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: '5.8.2'
//  testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.8.2'


  testCompileOnly 'org.projectlombok:lombok:1.18.22'
  testAnnotationProcessor 'org.projectlombok:lombok:1.18.22'
}

sourceSets {
  test {
    resources {
      srcDir file('src/test/java')
      exclude '**/*.java'
    }
  }
}

test {
  useJUnitPlatform()
  systemProperty "karate.options", System.properties.getProperty("karate.options")
  systemProperty "karate.env", System.properties.getProperty("karate.env")
  systemProperty "karate.username", System.properties.getProperty("karate.username")
  systemProperty "karate.password", System.properties.getProperty("karate.password")
  systemProperty "karate.client-id", System.properties.getProperty("karate.client-id")
  systemProperty "karate.client-secret", System.properties.getProperty("karate.client-secret")
  systemProperty "karate.isRegression", System.properties.getProperty("karate.isRegression")
  systemProperty "zephyrAuthToken", System.properties.getProperty("zephyrAuthToken")
  outputs.upToDateWhen { false }
}

task karateDebug(type: JavaExec) {
  classpath = sourceSets.test.runtimeClasspath
  mainClass = 'com.intuit.karate.cli.Main'
}
