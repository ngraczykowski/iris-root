ext {
  libraries = [:]

  //***********************************
  // Silent Eight
  //***********************************
  s8commonsVersion = "2.0.0"
  s8consulDiscoveryVersion = "2.4.0"
  s8consulGrpcRegistrationVersion = "1.0.0"

  // TODO all of this should be specified in agent-dependencies-common
  aspectjVersion = "1.9.6" //TODO use version from platform
  byteBuddyVersion = "1.11.1" //TODO use version from platform
  guavaVersion = "30.1.1-jre" //TODO use version from platform
  jbossXnioVersion = "3.5.9.Final"
  springBootAutoconfigureVersion = "2.12.0.RELEASE" //TODO it probably should be aligned with the rest of the spring-boot deps ("2.4.6")
}

// Silent Eight libraries
libraries.s8_commons_core = "com.silenteight.commons:silenteight-commons-core:$s8commonsVersion"
libraries.s8_spring_cloud_consul_discovery = "com.silenteight.spring.cloud.consul.discovery:silenteight-spring-cloud-consul-discovery:$s8consulDiscoveryVersion"
libraries.consul_grpc_registration = "com.silenteight.commons:consul-grpc-registration:$s8consulGrpcRegistrationVersion"

// Spring
libraries.spring_aop = "org.springframework:spring-aop"
libraries.spring_aspects = "org.springframework:spring-aspects"
libraries.spring_beans = "org.springframework:spring-beans"
libraries.spring_context = "org.springframework:spring-context"
libraries.spring_context_support = "org.springframework:spring-context-support"
libraries.spring_core = "org.springframework:spring-core"
libraries.spring_expression = "org.springframework:spring-expression"

libraries.spring_boot = "org.springframework.boot:spring-boot"
libraries.spring_boot_autoconfigure = "org.springframework.boot:spring-boot-autoconfigure"
libraries.spring_boot_starter_actuator = "org.springframework.boot:spring-boot-starter-actuator"
libraries.spring_boot_starter_logging = "org.springframework.boot:spring-boot-starter-logging"
libraries.spring_boot_starter_undertow = "org.springframework.boot:spring-boot-starter-undertow"
libraries.spring_boot_starter_web = "org.springframework.boot:spring-boot-starter-web"
libraries.spring_cloud_starter_consul_config = "org.springframework.cloud:spring-cloud-starter-consul-config"
libraries.spring_cloud_starter_sleuth = "org.springframework.cloud:spring-cloud-starter-sleuth"
libraries.spring_data_commons = "org.springframework.data:spring-data-commons"

// Project Reactor
libraries.reactor_core = "io.projectreactor:reactor-core"
libraries.reactor_test = "io.projectreactor:reactor-test"

// APIs
libraries.slf4j_api = "org.slf4j:slf4j-api"

// Others
libraries.aspectjrt = "org.aspectj:aspectjrt:$aspectjVersion"
libraries.aspectjtools = "org.aspectj:aspectjtools:$aspectjVersion"
libraries.brave_instrumentation_grpc = "io.zipkin.brave:brave-instrumentation-grpc"
libraries.byte_buddy = "net.bytebuddy:byte-buddy:$byteBuddyVersion"
libraries.byte_buddy_agent = "net.bytebuddy:byte-buddy-agent:$byteBuddyVersion"
libraries.commons_lang3 = "org.apache.commons:commons-lang3"
libraries.commons_text = "org.apache.commons:commons-text"

// gRPC
libraries.grpc_api = "io.grpc:grpc-api"
libraries.grpc_core = "io.grpc:grpc-core"
libraries.grpc_protobuf = "io.grpc:grpc-protobuf"
libraries.grpc_server_spring_boot_starter = "net.devh:grpc-server-spring-boot-starter"
libraries.grpc_client_spring_boot_starter = "net.devh:grpc-client-spring-boot-starter"
libraries.grpc_client_spring_boot_autoconfigure = "net.devh:grpc-server-spring-boot-autoconfigure:$springBootAutoconfigureVersion" //TODO
libraries.grpc_stub = "io.grpc:grpc-stub"

// Jackson
libraries.jackson_annotations = "com.fasterxml.jackson.core:jackson-annotations"
libraries.jackson_databind = "com.fasterxml.jackson.core:jackson-databind"
libraries.jackson_dataformat_xml = "com.fasterxml.jackson.dataformat:jackson-dataformat-xml"
libraries.jackson_datatype_jdk8 = "com.fasterxml.jackson.datatype:jackson-datatype-jdk8"
libraries.jackson_datatype_jsr310 = "com.fasterxml.jackson.datatype:jackson-datatype-jsr310"
libraries.jackson_module_afterburner = "com.fasterxml.jackson.module:jackson-module-afterburner"
libraries.jackson_module_parameter_names = "com.fasterxml.jackson.module:jackson-module-parameter-names"
libraries.jackson_module_paranamer = "com.fasterxml.jackson.module:jackson-module-paranamer"

libraries.guava = "com.google.guava:guava:$guavaVersion"
libraries.hibernate_validator = "org.hibernate.validator:hibernate-validator"
libraries.jakarta_validation_api = "jakarta.validation:jakarta.validation-api"
libraries.javax_cache_api = "javax.cache:cache-api"
libraries.javax_persistence_api = "javax.persistence:javax.persistence-api"
libraries.javax_transaction_api = "javax.transaction:javax.transaction-api"
libraries.jaxb_api = "javax.xml.bind:jaxb-api"
libraries.junit_jupiter_api = "org.junit.jupiter:junit-jupiter-api"

libraries.micrometer_prometheus = "io.micrometer:micrometer-registry-prometheus"
libraries.reactor_grpc_stub = "com.salesforce.servicelibs:reactor-grpc-stub"
libraries.snakeyaml = "org.yaml:snakeyaml"
libraries.tomcat_embed_el = "org.apache.tomcat.embed:tomcat-embed-el"
libraries.univocity_parsers = "com.univocity:univocity-parsers"

// Testing
libraries.groovy_all = "org.codehaus.groovy:groovy-all"
libraries.hamcrest = "org.hamcrest:hamcrest"
libraries.json_path = "com.jayway.jsonpath:json-path"
libraries.objenesis = "org.objenesis:objenesis"
libraries.spock_core = "org.spockframework:spock-core"

configurations.all {
  exclude group: 'org.glassfish', module: 'javax.el'
  exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'

  // Exclude outdated javax APIs from JBoss (newer version are already included)
  exclude group: 'org.jboss.spec.javax.annotation', module: 'jboss-annotations-api_1.2_spec'
  exclude group: 'org.jboss.spec.javax.servlet', module: 'jboss-servlet-api_4.0_spec'
  exclude group: 'org.jboss.spec.javax.transaction', module: 'jboss-transaction-api_1.2_spec'

  resolutionStrategy {
    failOnVersionConflict()
    preferProjectModules()

    //TODO try to remove those force
    force libraries.byte_buddy
    force libraries.byte_buddy_agent
    force libraries.guava
    force libraries.aspectjrt
    force libraries.aspectjtools

    // Fix for running with JDK11
    force "org.jboss.xnio:xnio-api:$jbossXnioVersion"
    force "org.jboss.xnio:xnio-nio:$jbossXnioVersion"
  }
}

dependencies {
  implementation platform(project(":agent-dependencies-common"))
  annotationProcessor platform(project(":agent-dependencies-common"))

  implementation libraries.slf4j_api
}
