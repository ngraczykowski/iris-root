plugins {
  id "idea"
  id "java-platform"
  id "maven-publish"
  id 'com.github.ben-manes.versions' version "0.36.0"
}

javaPlatform {
  allowDependencies()
}

ext {
  // NOTE(ahaczewski): Keep sorted alphabetically.
  antlr4Version = "4.8-1"
  aspectjVersion = "1.9.6"
  bouncyCastleVersion = "1.67"
  bouncyCastleExtVersion = "1.66"
  byteBuddyVersion = "1.10.18"
  caffeineVersion = "2.8.6"
  hibernateVersion = "5.4.10.Final"
  jakartaElVersion = "3.0.3"
  jakartaMailVersion = "1.6.5"
  netDevhGrpcSpringBootStarterVersion = "2.10.1.RELEASE"
  queryDslVersion = "4.4.0"
  restAssuredVersion = "4.2.0"
}

dependencies {
  // NOTE(ahaczewski): Do not change the order of platforms!
  api platform("org.junit:junit-bom:5.7.0")
  api platform("org.testcontainers:testcontainers-bom:1.15.0")
  api platform("jakarta.platform:jakarta.jakartaee-bom:8.0.0")
  api platform("io.projectreactor:reactor-bom:Dysprosium-SR14")
  api platform("io.grpc:grpc-bom:1.33.1")
  api platform("io.zipkin.brave:brave-bom:5.13.1")
  api platform("io.micrometer:micrometer-bom:1.6.1")
  api platform("com.google.protobuf:protobuf-bom:3.13.0")
  api platform("org.spockframework:spock-bom:1.3-groovy-2.5")
  api platform("org.springframework.boot:spring-boot-dependencies:2.3.6.RELEASE")
  api platform("org.springframework.cloud:spring-cloud-dependencies:Hoxton.SR9")

  // NOTE(ahaczewski): Keep each group sorted alphabetically.
  constraints {
    // Miscellaneous Dependencies
    api "co.elastic.logging:logback-ecs-encoder:0.1.3"
    api "com.esotericsoftware:kryo-shaded:4.0.2"
    api "com.github.ben-manes.caffeine:caffeine:$caffeineVersion"
    api "com.github.ben-manes.caffeine:jcache:$caffeineVersion"
    api "com.google.code.findbugs:jsr305:3.0.2"
    api "com.google.guava:guava:28.2-jre"
    api "com.oracle:ojdbc8:12.2.0.1"
    api "com.orbitz.consul:consul-client:1.4.2"
    api "com.querydsl:querydsl-apt:$queryDslVersion:jpa"
    api "com.querydsl:querydsl-jpa:$queryDslVersion"
    api "com.salesforce.servicelibs:reactor-grpc-stub:1.0.1"
    api "com.sun.mail:jakarta.mail:$jakartaMailVersion"
    api "com.thoughtworks.paranamer:paranamer:2.8"
    api "com.zaxxer:HikariCP:3.4.5"
    api "info.picocli:picocli:4.5.2"
    api "io.github.classgraph:classgraph:4.8.90"
    api "io.jsonwebtoken:jjwt:0.9.1"
    api "it.unimi.dsi:fastutil:8.4.3"
    api "jakarta.activation:jakarta.activation-api:1.2.2"
    api "jakarta.annotation:jakarta.annotation-api:1.3.5"
    api "jakarta.batch:jakarta.batch-api:1.0.2"
    api "jakarta.el:jakarta.el-api:$jakartaElVersion"
    api "jakarta.inject:jakarta.inject:1.0.1"
    api "jakarta.mail:jakarta.mail-api:$jakartaMailVersion"
    api "jakarta.persistence:jakarta.persistence-api:2.2.3"
    api "jakarta.servlet:jakarta.servlet-api:4.0.3"
    api "jakarta.transaction:jakarta.transaction-api:1.3.3"
    api "jakarta.validation:jakarta.validation-api:2.0.2"
    api "jakarta.xml.bind:jakarta.xml.bind-api:2.3.3"
    api "javax.cache:cache-api:1.1.1"
    api "net.bytebuddy:byte-buddy-agent:$byteBuddyVersion"
    api "net.bytebuddy:byte-buddy:$byteBuddyVersion"
    api "net.devh:grpc-client-spring-boot-starter:$netDevhGrpcSpringBootStarterVersion"
    api "net.devh:grpc-server-spring-boot-starter:$netDevhGrpcSpringBootStarterVersion"
    api "net.devh:grpc-spring-boot-starter:$netDevhGrpcSpringBootStarterVersion"
    api "net.logstash.logback:logstash-logback-encoder:6.4"
    api "org.antlr:antlr4-runtime:$antlr4Version"
    api "org.antlr:antlr4:$antlr4Version"
    api "org.apache.commons:commons-text:1.9"
    api "org.aspectj:aspectjrt:$aspectjVersion"
    api "org.aspectj:aspectjtools:$aspectjVersion"
    api "org.aspectj:aspectjweaver:$aspectjVersion"
    api "org.assertj:assertj-core:3.18.1"
    api "org.awaitility:awaitility:4.0.3"
    api "org.bouncycastle:bcmail-jdk15on:$bouncyCastleVersion"
    api "org.bouncycastle:bcpg-jdk15on:$bouncyCastleVersion"
    api "org.bouncycastle:bcpkix-jdk15on:$bouncyCastleVersion"
    api "org.bouncycastle:bcprov-ext-jdk15on:$bouncyCastleExtVersion"
    api "org.bouncycastle:bcprov-jdk15on:$bouncyCastleVersion"
    api "org.freemarker:freemarker:2.3.30"
    api "org.glassfish:jakarta.el:$jakartaElVersion"
    api "org.hibernate.validator:hibernate-validator:6.0.20.Final"
    api "org.hibernate:hibernate-core:$hibernateVersion"
    api "org.hibernate:hibernate-envers:$hibernateVersion"
    api "org.hibernate:hibernate-jcache:$hibernateVersion"
    api "org.jetbrains:annotations:16.0.3"
    api "org.liquibase:liquibase-core:3.8.9"
    api "org.lz4:lz4-java:1.7.1"
    api "org.postgresql:postgresql:42.2.18"
    api "org.projectlombok:lombok:1.18.16"
    api "org.slf4j:slf4j-api:1.7.30"

    // Testing
    api "com.jayway.jsonpath:json-path:2.4.0"
    api "com.revinate:assertj-json:1.2.0"
    api "io.rest-assured:rest-assured:$restAssuredVersion"
    api "io.rest-assured:spring-mock-mvc:$restAssuredVersion"
    api "junit:junit:4.13.1"
    api "org.codehaus.groovy:groovy-all:2.5.13"
    api "org.hamcrest:hamcrest:2.2"
  }
}

publishing {
  publications {
    sepDependencies(MavenPublication) {
      from components.javaPlatform
    }
  }
}

tasks.named("dependencyUpdates").configure {
  checkConstraints = true
}
