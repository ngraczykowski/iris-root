plugins {
  id "groovy"
  id "com.google.cloud.tools.jib"
  id "com.silenteight.iris.build.spring-boot-application"
}

description = "Simulator"

dependencies {
  implementation project(":simulator-common-web")
  implementation project(":simulator-dataset")
  implementation project(":simulator-db-changelog")
  implementation project(":simulator-management")
  implementation project(":simulator-model")
  implementation project(":simulator-processing")
  implementation project(":simulator-retention")

  implementation libs.silenteight.sep.auth

  implementation libs.spring.boot.starter.actuator
  implementation libs.spring.boot.starter.web

  // mmastylo: jackson.module.kotlin can be removed once spring and or jackson is bumped
  // kotlin is required by minio
  // https://stackoverflow.com/questions/67630048/springboot-2-5-0-for-jackson-kotlin-classes-support-please-add-com-fasterxml-ja
  implementation libs.jackson.module.kotlin

  implementation libs.grpc.api
  implementation libs.grpc.stub
  implementation libs.grpc.census
  implementation libs.grpc.spring.boot.starter

  //Sentry
  runtimeOnly libs.sentry.spring.boot.starter
  runtimeOnly libs.sentry.logback

  runtimeOnly libs.hikari.cp
  runtimeOnly libs.postgresql

  aspect libs.silenteight.sep.base.aspects

  testImplementation project(":simulator-common-web-testing")

  testImplementation libs.spring.integration.test
}

publishing {
  publications {
    bootJava(MavenPublication) {
      artifact bootJar
    }
  }
}
