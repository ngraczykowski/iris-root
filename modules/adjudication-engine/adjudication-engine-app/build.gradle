plugins {
  id "java"
  id "maven-publish"
  id "com.google.cloud.tools.jib"
  id "org.springframework.boot"
}

description = "Adjudication Engine Application"

dependencies {
  implementation project(":adjudication-engine-alerts")
  implementation project(":adjudication-engine-analysis")
  implementation project(":adjudication-engine-comments")
  implementation project(":adjudication-engine-common")
  implementation project(":adjudication-engine-dataset")
  implementation project(":adjudication-engine-features")
  implementation project(":proto-adjudication-engine-internal-protos")
  implementation project(":adjudication-engine-metrics")
  implementation project(":adjudication-engine-mock-agents")
  implementation project(":adjudication-engine-mock-datasource")
  implementation project(":adjudication-engine-mock-governance")
  implementation project(":adjudication-engine-solving")

  implementation libraries.spring_cloud_consul_discovery
  implementation libraries.spring_cloud_starter_consul_config

  // Utilities
  implementation libraries.commons_lang3
  implementation libraries.commons_text
  implementation libraries.guava
  implementation libraries.shedlock_spring
  implementation libraries.shedlock_provider_jdbc_template
  runtimeOnly libraries.ecs_logging_core
  runtimeOnly libraries.logback_ecs_encoder

  // Base Libraries
  implementation libraries.silenteight_sep_base_common
  implementation libraries.silenteight_commons_app

  // Application Starters
  implementation libraries.spring_boot_starter_actuator
  implementation libraries.spring_boot_starter_logging
  implementation libraries.spring_boot_starter_webflux
  implementation libraries.spring_boot_starter_oauth2_resource_server
  implementation libraries.spring_boot_starter_oauth2_client
  implementation libraries.spring_boot_starter_security
  implementation libraries.micrometer_prometheus

  // Sentry
  runtimeOnly libraries.sentry_spring_boot_starter
  runtimeOnly libraries.sentry_logback

  // Security
  implementation libraries.spring_security_config
  implementation libraries.spring_security_core
  implementation libraries.spring_security_web

  // Spring Sleuth
  implementation libraries.spring_cloud_starter_sleuth

  // Validator
  implementation libraries.tomcat_embed_el
  implementation libraries.hibernate_validator

  // APIs
  implementation libraries.jakarta_persistence_api
  implementation libraries.jakarta_transaction_api

  // Jackson
  implementation libraries.jackson_annotations
  implementation libraries.jackson_databind
  runtimeOnly libraries.jackson_dataformat_xml
  runtimeOnly libraries.jackson_datatype_jdk8
  runtimeOnly libraries.jackson_datatype_jsr310
  runtimeOnly libraries.jackson_module_afterburner
  runtimeOnly libraries.jackson_module_paranamer
  runtimeOnly libraries.jackson_module_parameter_names

  // Database
  implementation libraries.liquibase_core
  implementation libraries.spring_jdbc
  implementation libraries.spring_data_jpa
  implementation libraries.hikari_cp
  implementation libraries.hibernate_core
  runtimeOnly libraries.postgresql
  runtimeOnly libraries.hibernate_jcache
  runtimeOnly libraries.caffeine
  runtimeOnly libraries.caffeine_jcache
  runtimeOnly libraries.liquibase_sessionlock

  // Messaging
  implementation libraries.amqp_client
  implementation libraries.lz4_java
  implementation libraries.spring_boot_starter_integration
  implementation libraries.spring_integration_amqp
  implementation libraries.spring_integration_core
  implementation libraries.spring_integration_http

  // GRPC
  implementation libraries.brave_instrumentation_grpc
  implementation libraries.grpc_server_spring_boot_starter
  implementation libraries.grpc_client_spring_boot_starter

  // AspectJ
  implementation libraries.aspectjrt
  aspect libraries.silenteight_sep_base_aspects
  compileOnly libraries.spring_web
  compileOnly libraries.spring_tx
  // Testing
  testImplementation libraries.junit_jupiter_api
  testImplementation libraries.silenteight_sep_base_testing
  testImplementation libraries.adjudication_engine_api
  testImplementation libraries.awaitility
  testImplementation libraries.spring_boot_starter_test
}

jar {
  manifest {
    attributes "Main-Class": "com.silenteight.adjudication.engine.app.AdjudicationEngineApplication"
  }
}
