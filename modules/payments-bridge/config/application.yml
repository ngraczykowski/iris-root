#---------------------------------------------------------------------------------------------------
# REST SERVER
#---------------------------------------------------------------------------------------------------
server:
  port: 24602

#---------------------------------------------------------------------------------------------------
# GRPC SERVER
#---------------------------------------------------------------------------------------------------
grpc:
  server:
    port: 24603
  client:
    ae:
      address: static://localhost:24803
      negotiation-type: PLAINTEXT
    data-source:
      address: static://localhost:${grpc.server.port}
      negotiation-type: PLAINTEXT

pb:
  #-------------------------------------------------------------------------------------------------
  # DATABASE
  #-------------------------------------------------------------------------------------------------
  db:
    host: localhost
    port: 24681
    schema: public
    name: paymentsbridge
    username: paymentsbridge
    password: paymentsbridge

  #-------------------------------------------------------------------------------------------------
  # WEB CONCURRENCY
  #-------------------------------------------------------------------------------------------------
  web:
    threads:
      io: 2
      worker: 4

  #-------------------------------------------------------------------------------------------------
  # MESSAGING CONCURRENCY
  #-------------------------------------------------------------------------------------------------
  messaging:
    concurrency: 2
    prefetch: 2

  #-------------------------------------------------------------------------------------------------
  # CMAPI CALLBACK
  #-------------------------------------------------------------------------------------------------
  cmapi:
    callback:
      endpoint: "http://localhost:5000/callback-recommendation"
      enabled: false

spring:
  #-------------------------------------------------------------------------------------------------
  # MULTI-THREADING
  #-------------------------------------------------------------------------------------------------
  task:
    execution:
      pool:
        core-size: 2
        max-size: 4
        queue-capacity: 1000

  #-------------------------------------------------------------------------------------------------
  # RABBITMQ
  #-------------------------------------------------------------------------------------------------
  rabbitmq:
    host: localhost
    port: 24160
    username: dev
    password: dev
    virtual-host: /

#---------------------------------------------------------------------------------------------------
# SECURITY
#---------------------------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Ingress authorization
#------------------------------------------------------------------------------
keycloak:
  realm: sierra
  auth-server-url: https://auth.silent8.cloud
  ssl-required: external
  resource: sierra-dev-api
  use-resource-role-mappings: true
  bearer-only: true

#------------------------------------------------------------------------------
# Egress authorization
#
# NOTE(ahaczewski): The configuration below is for development purposes only,
#   and the `egress-mock` realm in our Keycloak is used to simulate the customer
#   auth server.
#
#------------------------------------------------------------------------------
rest:
  security:
    issuer-uri: https://auth.silent8.cloud/realms/egress-mock

security:
  oauth2:
    client:
      client-id: cmapi-dev
      # Set the client-secret via environment variable SECURITY_OAUTH2_CLIENT_CLIENT_SECRET
      user-authorization-uri: ${rest.security.issuer-uri}/protocol/openid-connect/auth
      access-token-uri: ${rest.security.issuer-uri}/protocol/openid-connect/token
      scope: openid
      grant-type: client_credentials
