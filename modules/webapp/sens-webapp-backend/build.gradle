plugins {
  id "com.silenteight.iris.build.container-image"
  id "com.silenteight.iris.build.spring-boot-application"
}

description = "SENS WebApp Backend"

dependencies {
  implementation project(":sens-webapp-audit")
  implementation project(":sens-webapp-audit-api")
  implementation project(":sens-webapp-common")
  implementation project(":sens-webapp-db-changelog")
  implementation project(":sens-webapp-endpoint")
  implementation project(":sens-webapp-logging")
  implementation project(":sens-webapp-notification")
  implementation project(":sens-webapp-permission")
  implementation project(":sens-webapp-report")
  implementation project(":sens-webapp-role")
  implementation project(":sens-webapp-sso")
  implementation project(":sens-webapp-user")

  implementation libs.silenteight.commons.app
  implementation libs.silenteight.commons.core
  implementation libs.silenteight.sep.auth
  implementation libs.silenteight.sep.usermanagement.api
  implementation libs.silenteight.sep.usermanagement.keycloak

  implementation libs.bouncycastle.bcprov
  implementation libs.commons.lang3

  implementation libs.hibernate.envers
  implementation libs.hibernate.validator

  implementation libs.spring.boot.starter.actuator

  implementation libs.spring.boot.starter.web

  implementation libs.spring.data.jpa

  implementation libs.spring.security.web
  implementation libs.spring.security.config
  implementation libs.spring.security.cas

  implementation libs.springdoc.ui
  implementation libs.springdoc.data.rest
  implementation libs.springdoc.security

  implementation libs.spring.cloud.consul.discovery
  implementation libs.spring.cloud.starter.consul.config
  implementation libs.freemarker

  implementation libs.protobuf.java.util

  implementation libs.grpc.protobuf
  implementation libs.grpc.stub
  implementation libs.grpc.client.spring.boot.starter

  implementation libs.hikari.cp
  runtimeOnly libs.liquibase.core
  runtimeOnly libs.liquibase.sessionlock

  implementation doNotUseLibs.vavr
  implementation libs.cronutils

  //Sentry
  runtimeOnly libs.sentry.spring.boot.starter
  //having this at runtime ensure sending all ERROR level logs to Sentry
  runtimeOnly libs.sentry.logback

  runtimeOnly libs.postgresql

  testImplementation project(":sens-webapp-db-changelog")
  testImplementation libs.rest.assured
  testImplementation libs.rest.assured.spring.mock.mvc
  testImplementation libs.spring.security.test

  aspect libs.silenteight.sep.base.aspects
}

jar {
  manifest {
    attributes "Main-Class": "com.silenteight.sens.webapp.backend.WebApplication"
  }
}
