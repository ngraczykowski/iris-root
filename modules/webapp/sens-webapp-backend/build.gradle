plugins {
  id "java"
  id "org.springframework.boot"
  id "io.freefair.aspectj.post-compile-weaving"
}

description = "SENS WebApp Backend"

configurations {
  implementation.extendsFrom starterSpringApp
  implementation.extendsFrom starterJackson

  implementation.extendsFrom starterDatabase
  runtimeOnly.extendsFrom starterDatabaseRuntime

  implementation.extendsFrom starterGrpc

  testImplementation.extendsFrom starterDataJpaTest
}

dependencies {
  compile project(":sens-webapp-kernel")

  compile libraries.bouncycastle_bcprov
  compile libraries.commons_lang3
  compile libraries.jjwt

  compile libraries.spring_boot_starter_actuator
  compile libraries.spring_boot_starter_undertow
  compile libraries.spring_boot_starter_web

  compile libraries.spring_security_web
  compile libraries.spring_security_config
  compile libraries.spring_security_cas

  // TODO(bgulowaty): move to separate module (WA-83)
  implementation libraries.keycloak
  implementation libraries.keycloak_spring_security_adapter
  implementation libraries.keycloak_admin_client

  implementation libraries.caffeine
  implementation libraries.streamex

  compile libraries.hibernate_envers

  implementation project(":sens-webapp-common")
  implementation project(":sens-webapp-db-changelog")

  implementation libraries.silenteight_spring_cloud_consul_discovery
  implementation libraries.spring_cloud_starter_consul_config

  implementation libraries.grpc_stub

  implementation libraries.protobuf_java_util

  implementation libraries.vavr

  runtimeOnly libraries.caffeine

  testImplementation project(":sens-webapp-db-changelog")
  testImplementation libraries.rest_assured
  testImplementation libraries.rest_assured_spring_mock_mvc

  aspect project(":sens-webapp-aspects")
}

bootJar {
  mainClassName = "com.silenteight.sens.webapp.backend.WebApplication"
}
