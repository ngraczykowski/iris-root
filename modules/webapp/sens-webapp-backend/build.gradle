plugins {
  id "java"
  id "io.freefair.aspectj.post-compile-weaving"
  id "maven-publish"
  id "org.springframework.boot"
}

description = "SENS WebApp Backend"

configurations {
  implementation.extendsFrom starterSpringApp
  implementation.extendsFrom starterJackson

  implementation.extendsFrom starterDatabase
  runtimeOnly.extendsFrom starterDatabaseRuntime

  implementation.extendsFrom starterGrpcClient

  testImplementation.extendsFrom starterDataJpaTest
}

dependencies {
  implementation libraries.silenteight_sep_usermanagement_api
  implementation libraries.silenteight_sep_usermanagement_keycloak
  implementation libraries.bouncycastle_bcprov
  implementation libraries.commons_lang3
  implementation libraries.jjwt

  implementation libraries.hibernate_envers
  implementation libraries.hibernate_validator

  implementation libraries.spring_boot_starter_actuator
  implementation libraries.spring_boot_starter_undertow
  implementation libraries.spring_boot_starter_web

  implementation libraries.spring_security_web
  implementation libraries.spring_security_config
  implementation libraries.spring_security_cas

  implementation project(":sens-webapp-audit")
  implementation project(":sens-webapp-audit-api")
  implementation project(":sens-webapp-common")
  implementation project(":sens-webapp-db-changelog")
  implementation project(":sens-webapp-logging")
  implementation project(":sens-webapp-notification")
  implementation project(":sens-webapp-report")
  implementation project(":sens-webapp-user")

  implementation libraries.springdoc_ui
  implementation libraries.springdoc_data_rest
  implementation libraries.springdoc_security

  implementation libraries.silenteight_spring_cloud_consul_discovery
  implementation libraries.spring_cloud_starter_consul_config
  implementation libraries.freemarker

  implementation libraries.protobuf_java_util

  // Oracle is used by plugins to allow connecting to Oracle DB
  implementation libraries.oracle

  implementation libraries.vavr
  implementation libraries.cronutils

  testImplementation project(":sens-webapp-db-changelog")
  testImplementation libraries.rest_assured
  testImplementation libraries.rest_assured_spring_mock_mvc
  testImplementation libraries.spring_security_test
}

jar {
  manifest {
    attributes "Main-Class": "com.silenteight.sens.webapp.backend.WebApplication"
  }
}
