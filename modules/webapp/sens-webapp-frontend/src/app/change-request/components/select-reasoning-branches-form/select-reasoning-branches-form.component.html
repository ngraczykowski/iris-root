<div class="form">
  <form [formGroup]="form" #formDir="ngForm" class="form__content" (ngSubmit)="onFormSubmit()">
    <mat-form-field appearance="outline" class="mat-form-field--full-width">
      <mat-label [translate]="translatePrefix + 'decisionTree.label'"></mat-label>
      <input
        formControlName="decisionTreeId"
        matInput
        required
        appNumbersOnly
      >
      <mat-hint [translate]="translatePrefix + 'decisionTree.hint'"></mat-hint>
      <mat-error [translate]="translatePrefix + 'decisionTree.errorEmpty'"
                 *ngIf="form.controls.decisionTreeId.hasError('required')"></mat-error>
      <mat-error [translate]="translatePrefix + 'decisionTree.errorValue'"
                 *ngIf="form.controls.decisionTreeId.hasError('pattern')"></mat-error>
      <mat-error [translate]="translatePrefix + 'decisionTree.errorDoesNotExist'"
                 *ngIf="form.controls.decisionTreeId.hasError(decisionTreeExistsErrorCode)"></mat-error>

    </mat-form-field>

    <mat-button-toggle-group formControlName="group" name="rbInput" aria-label="RB Input">
      <mat-button-toggle value="id">
        <span [translate]="translatePrefix + 'rbIdType.rbID'"></span>
      </mat-button-toggle>
      <mat-button-toggle value="featureVector">
        <span [translate]="translatePrefix + 'rbIdType.rbSignature'"></span>
      </mat-button-toggle>
    </mat-button-toggle-group>

    <mat-form-field *ngIf="form.controls.group.value === 'id'" class="mat-form-field--full-width"
                    appearance="outline">
      <mat-label [translate]="translatePrefix + 'rbId.label'"></mat-label>
      <textarea
        formControlName="reasoningBranchIds"
        matInput
        required
        matTextareaAutosize
        matAutosizeMinRows=5
        matAutosizeMaxRows=10
      ></textarea>
      <mat-hint>
        {{ translatePrefix + 'rbId.hint' | translate: {length: form.controls.reasoningBranchIds.value?.length} }}
      </mat-hint>
      <mat-error *ngIf="form.controls.reasoningBranchIds.hasError('maxlength')">
        {{ translatePrefix + 'rbId.errorCharacterLimit' | translate: {length: form.controls.reasoningBranchIds.value?.length} }}
      </mat-error>
      <mat-error
        *ngIf="form.controls.reasoningBranchIds.hasError('required')"
        [translate]="translatePrefix + 'rbId.errorEmpty'"
      ></mat-error>
      <mat-error
        *ngIf="form.controls.reasoningBranchIds.hasError('verificationFail')"
        [translate]="translatePrefix + 'rbId.errorVerificationFail'"
      ></mat-error>
    </mat-form-field>

    <mat-form-field *ngIf="form.controls.group.value === 'featureVector'"
                    class="mat-form-field--full-width" appearance="outline">
      <mat-label [translate]="translatePrefix + 'rbSignature.label'"></mat-label>
      <textarea
        formControlName="reasoningBranchSignature"
        matInput
        required
        matTextareaAutosize
        matAutosizeMinRows=5
        matAutosizeMaxRows=10
      ></textarea>
      <mat-hint>
        {{ translatePrefix + 'rbSignature.hint' | translate: {length: form.controls.reasoningBranchSignature.value?.length} }}
      </mat-hint>
      <mat-error *ngIf="form.controls.reasoningBranchSignature.hasError('maxlength')">
        {{ translatePrefix + 'rbSignature.errorCharacterLimit' | translate: {length: form.controls.reasoningBranchSignature.value?.length} }}
      </mat-error>
      <mat-error
        *ngIf="form.controls.reasoningBranchSignature.hasError('required')"
        [translate]="translatePrefix + 'rbSignature.errorEmpty'"
      ></mat-error>
      <mat-error
        *ngIf="form.controls.reasoningBranchSignature.hasError('verificationFail')"
        [translate]="translatePrefix + 'rbSignature.errorVerificationFail'"
      ></mat-error>
    </mat-form-field>
    <div class="form__footer">
      <a (click)="resetForm(formDir)" mat-button color="primary">
        <span [translate]="translatePrefix + 'footer.reset'"></span>
      </a>
      <button type="submit" mat-flat-button color="primary">
        <span [translate]="translatePrefix + 'footer.cta'"></span>
      </button>
    </div>

  </form>
</div>
