<mat-accordion>
  <mat-expansion-panel *ngFor="let circuitBreakerElement of circuitBreakerList"
                       [attr.id]="'Location' + circuitBreakerElement.id"
                       (opened)="initDiscrepanciesTable(
                       circuitBreakerElement.branchId.decisionTreeId,
                       circuitBreakerElement.branchId.featureVectorId
                       )"
                       (closed)="resetDiscrepanciesTable()"
                       class="mat-expansion-panel--flat mat-elevation-z0">
    <mat-expansion-panel-header>
      <mat-panel-title>
        {{ translatePrefix + 'header.id' | translate:{
        decisionTreeId: circuitBreakerElement.branchId.decisionTreeId,
        reasoningBranchId: circuitBreakerElement.branchId.featureVectorId
      } }}
      </mat-panel-title>
      <mat-panel-description>
        {{ translatePrefix + 'header.disabled' | translate:{
        date: circuitBreakerElement.detectedAt | date:dateFormatting
      } }}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <app-state *ngIf="loadingDetails"
               [stateContent]="stateLoading"></app-state>
    <app-state *ngIf="showError"
               [stateContent]="stateError"></app-state>
    <ng-container *ngIf="showDetails">
      <div class="dynamic-table" [class.dynamic-table--loading]="loadingTableContent">
        <div class="dynamic-table__spinner-container">
          <mat-spinner></mat-spinner>
        </div>
        <app-circuit-breaker-alerts-table
                [discrepanciesList]="discrepanciesList"
                (page)="reloadTableContent($event)"></app-circuit-breaker-alerts-table>
      </div>
      <mat-paginator [pageSizeOptions]="rowsPerPage"
                     showFirstLastButtons
                     [length]="numberOfRows"
                     (page)="reloadTableContent($event)"></mat-paginator>
      <mat-action-row>
        <button mat-button color="primary">
          <span [translate]="translatePrefix + 'footer.buttonArchiveRequest'"
                (click)="archiveDialog.open()"></span>
        </button>
        <button mat-flat-button
                color="primary"
                (click)="createChangeRequest(
                circuitBreakerElement.branchId.decisionTreeId,
                circuitBreakerElement.branchId.featureVectorId
                )">
          <span [translate]="translatePrefix + 'footer.buttonChangeRequest'"></span>
        </button>
      </mat-action-row>
    </ng-container>

    <app-dialog-instance #archiveDialog
       [header]="'circuitBreakerDashboard.element.archiveDialog.title' | translate"
       [description]="'circuitBreakerDashboard.element.archiveDialog.description' | translate :
          { descriptionValue: circuitBreakerElement.branchId.decisionTreeId
          + '-' +  circuitBreakerElement.branchId.featureVectorId}">
      <button mat-button appDialogButton color="primary">
        {{'circuitBreakerDashboard.element.archiveDialog.cancellation' | translate }}</button>
      <button mat-flat-button appDialogButton color="primary"
          (click)="archive(circuitBreakerElement.branchId.decisionTreeId,
            circuitBreakerElement.branchId.featureVectorId)">
        {{'circuitBreakerDashboard.element.archiveDialog.confirmation' | translate }}</button>
    </app-dialog-instance>

  </mat-expansion-panel>
</mat-accordion>
