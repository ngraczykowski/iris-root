plugins {
  id('com.silenteight.iris.build.root-build')

  alias(libs.plugins.freefair.aspectj.weaving) apply false
}

subprojects {Project project ->
  pluginManager.withPlugin("java") {
    project.pluginManager.apply "io.freefair.aspectj.post-compile-weaving"

    project.dependencies {
      implementation libs.jaxb.api
    }
  }
}

tasks.named(BasePlugin.CLEAN_TASK_NAME).configure {
  dependsOn tasks.named("deleteWebappPlugins")
}

tasks.register("deleteWebappPlugins", Delete).configure {
  delete fileTree("${rootProject.projectDir}/plugin/webapp") {
    include "*.jar"
  }
}

configure(subprojects - project(":sens-webapp-common-testing")) {Project subproject ->
  subproject.pluginManager.withPlugin("java") {
    subproject.dependencies {
      testImplementation project(":sens-webapp-common-testing")
    }
  }
}
