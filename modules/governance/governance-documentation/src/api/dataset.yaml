openapi: 3.0.3
info:
  title: Dataset
  description: Dataset for simulation
  version: 0.1.0
servers:
  - url: 'https'

paths:
  /datasets?state={state}:
    get:
      description: Returns a list of datasets
      parameters:
        - in: query
          name: state
          required: false
          description: 'Policy state'
          schema:
            $ref: '#/components/schemas/DatasetState'
      responses:
        200:
          description: List of datasets
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DatasetValue'

  /datasets:
    post:
      description: Create a new dataset
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DatasetCreation'
      responses:
        201:
          description: Created

components:
  schemas:

    DatasetState:
      type: string
      enum: [ current, archived ]

    DatasetValue:
      type: object
      properties:
        id:
          type: string
        datasetId:
          type: number
        name:
          type: string
        description:
          type: string
        query:
          type: object
          $ref: '#/components/schemas/Query'
        updatedAt:
          type: string
        updatedBy:
          type: string
        createdAt:
          type: string
        createdBy:
          type: string
      example:
        id: 'a9b45451-6fde-4832-8dc0-d17b4708d8ca'
        datasetId: 2
        name: 'Dataset name'
        description: 'Dataset description'
        query:
          alertGenerationDate:
            from: '2004-02-12T15:19:21Z'
            to: '2005-02-12T15:19:21Z'
        updatedAt: '2004-02-12T15:19:21Z'
        updatedBy: 'UserName'
        createdAt: '2004-02-15T15:19:21Z'
        createdBy: 'UserName2'


    DatasetCreation:
      type: object
      required:
        - id
        - name
        - query
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        query:
          type: object
          $ref: '#/components/schemas/Query'
      example:
        id: 'a9b45451-6fde-4832-8dc0-d17b4708d8ca'
        name: 'New dataset'
        description: 'Dataset description'
        query:
          alertGenerationDate:
            from: '2004-02-12T15:19:21Z'
            to: '2005-02-12T15:19:21Z'

    Query:
      type: object
      properties:
        alertGenerationDate:
          type: object
          $ref: '#components/schemas/RangeQuery'
      example:
        alertGenerationDate:
          from: '2004-02-12T15:19:21Z'
          to: '2005-02-12T15:19:21Z'


    RangeQuery:
      type: object
      properties:
        from:
          type: string
        to:
          type: string
      example:
        from: '2004-02-12T15:19:21Z'
        to: '2005-02-12T15:19:21Z'


