spring:
  application:
    name: warehouse
  jpa:
    database: POSTGRESQL
    show-sql: false
    open-in-view: false
    database-platform: com.silenteight.sep.base.common.support.hibernate.FixedPostgreSql95Dialect
  liquibase:
    change-log: classpath:db/changelog/db.changelog-master.xml
    default-schema: ${warehouse.db.schema:public}
    contexts: default

warehouse:
  report:
    default-bucket: report
    removal:
      cron: "0 0 1 * * ?"
      duration-time: P1D
    file-name:
      # Available patterns: [reportType], [from], [to], [timestamp]
      production-pattern: "[reportType]_Prod_[from]_To_[to].csv"
      # Available patterns: [reportType], [analysisId], [timestamp]
      simulation-pattern: "[reportType]_Sim_[analysisId].csv"
    copy-csv-pattern: "COPY ( %s ) TO STDOUT WITH (FORMAT CSV, HEADER)"
  environment:
    prefix: itest
  es:
    production-query-index: ${warehouse.environment.prefix}_production_alert
    production-match-query-index: ${warehouse.environment.prefix}_production_match
    scroll:
      search:
        batch-size: 1
        keep-alive-seconds: 10
  alert-mapping:
    country-source-key: lob_country
  match-mapping:

warehouse.reports.v2:
  reports:
    - name: TEST_REPORT
      type: production
      description: Test report
      selectSqlQuery: >
        SELECT (payload ->> 'fvSignature') AS "Reasoning Branch ID",
               discriminator AS "Alert S8 ID",
               name AS "Alert S8 Name",
               recommendation_date
        FROM warehouse_alert
#        WHERE recommendation_date BETWEEN DATE '${from}' AND DATE '${to}'

logging:
  level:
    com.silenteight.warehouse.report: DEBUG
    com.silenteight.warehouse.common.opendistro.elastic: DEBUG
