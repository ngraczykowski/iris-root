<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.3.xsd">
    <changeSet author="tomaszdrozdz (generated)" id="1648634122224-1">
        <createTable tableName="warehouse_daily_policy_statistics">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="warehouse_daily_policy_statistics_pkey"/>
            </column>
            <column name="alerts_count" type="INTEGER"/>
            <column name="day" type="date"/>
            <column name="effectiveness_percent" type="DOUBLE"/>
            <column name="efficiency_percent" type="DOUBLE"/>
            <column name="false_positives_count" type="INTEGER"/>
            <column name="manual_investigations_count" type="INTEGER"/>
            <column name="potential_true_positives_count" type="INTEGER"/>
        </createTable>
    </changeSet>

  <changeSet id="warehouse-2.4.0-1" author="anowicki">
    <addColumn tableName="warehouse_simulation_alert">
      <column name="migrated" type="boolean"/>
    </addColumn>
    <sql splitStatements="true">
      CREATE TABLE warehouse_simulation_match (
      id bigint generated by default as identity,
      name varchar(128) not null,
      analysis_name varchar(128) not null,
      alert_name varchar(128) not null,
      created_at timestamp DEFAULT CURRENT_TIMESTAMP,
      payload jsonb not null
      ) PARTITION BY LIST (analysis_name);
    </sql>
  </changeSet>
</databaseChangeLog>
