warehouse:
  alert-mapping:
    country-source-key: access_permission_tag
    ignored-keys:
  match-mapping:
  environment:
    prefix: sierra
  sampling:
    time-field-name: alert_create_time

  indexer.diagnostic.enabled: true

warehouse.messaging:
  broker:
    alert-production-indexing:
      queue-name: wh.prioritized-index-request.production
      routing-key: command.index-request.production
      max-priority: 10
    to-remove:
      bindings:
        - queue-name: wh.index-request.production
          exchange: bridge.command
          routing-key: command.index-request.production
  integration:
    production-indexing-inbound:
      queue-name: wh.prioritized-index-request.production

warehouse.report.rbs:
  production:
    index-name: ${warehouse.es.production-match-query-index}
    date-field-name: alert_create_time
    columns:
      - name: match_feature_vector_signature
        label: Reasoning Branch ID
      - name: match_policy
        label: Policy Id
      - name: match_policy_title
        label: Policy Title
      - name: match_step
        label: Step Id
      - name: match_step_title
        label: Step Title
      - name: match_solution
        label: S8 Match Resolution
      - name: match_category_values_categories/crossmatch
        label: Name Address Crossmatch
      - name: match_category_values_categories/specificTerms
        label: Specific Terms
      - name: match_category_values_categories/historicalRiskAssessment
        label: Historical Risk Assessment
      - name: match_category_values_categories/watchlistType
        label: Watchlist Type
      - name: match_category_values_categories/matchType
        label: Match Type
      - name: match_category_values_categories/companyNameSurrounding
        label: Company Name Surrounding
      - name: match_feature_values_features/geo
        label: Geo
      - name: match_feature_values_features/name
        label: Name
      - name: match_feature_values_features/nameMatchedText
        label: Name Matched Text
      - name: match_feature_values_features/organizationName
        label: Organization Name
    grouping-columns: []
#      - name: alert_analyst_decision
#        grouping-values:
#          - value: analyst_decision_true_positive
#            label: analyst_decision_FP
#          - value: analyst_decision_false_positive
#            label: analyst_decision_PTP

  simulation:
    date-field-name: index_timestamp
    columns:
      - name: alert_match_reason:feature_vector_signature
        label: Reasoning Branch ID
      - name: alert_match_reason:policy
        label: Policy Id
      - name: alert_match_reason:policy_title
        label: Policy Title
      - name: alert_match_reason:step
        label: Step Id
      - name: alert_match_reason:step_title
        label: Step Title
      - name: alert_match_solution
        label: S8 Match Resolution
      - name: alert_categories/crossmatch:value
        label: Name Address Crossmatch
      - name: alert_categories/specificTerms:value
        label: Specific Terms
      - name: alert_categories/historicalRiskAssessment:value
        label: Historical Risk Assessment
      - name: alert_categories/watchlistType:value
        label: Watchlist Type
      - name: alert_categories/matchType:value
        label: Match Type
      - name: alert_categories/companyNameSurrounding:value
        label: Company Name Surrounding
      - name: alert_features/geo:solution
        label: Geo
      - name: alert_features/name:solution
        label: Name
      - name: alert_features/nameMatchedText:solution
        label: Name Matched Text
      - name: alert_features/organizationName:solution
        label: Organization Name
    grouping-columns: []
#      - name: alert_analyst_decision
#        grouping-values:
#          - value: analyst_decision_true_positive
#            label: analyst_decision_FP
#          - value: analyst_decision_false_positive
#            label: analyst_decision_PTP

warehouse.report.billing:
  year-field-name: alert_recommendationYear
  month-field-name: alert_recommendationMonth
  date-field-name: alert_create_time
  year-month-label: date
  transpose-column:
    name: alert_s8_recommendation
    grouping-values:
      - name: ACTION_FALSE_POSITIVE
        label: count_solved_FP
      - name: ACTION_POTENTIAL_TRUE_POSITIVE
        label: count_solved_PTP
      - name: ACTION_INVESTIGATE
        label: count_solved_MI
    counter-label: count_alerts_received
    significant-values: [ ACTION_FALSE_POSITIVE, ACTION_POTENTIAL_TRUE_POSITIVE]
    significant-summation-label: count_alerts_solved

warehouse.report.metrics:
  production:
    date-field:
      name: alert_create_time
      label: Date
      source-pattern: yyyy-MM-dd HH:mm:ss
      target-pattern: yyyy-MM
    risk-type:
      name: alert_extendedAttribute5
      label: Risk Type
    hit-type:
      name: alert_categories/hitType
      label: Hit Type
    country:
      name: s8_country
      label: Country
    recommendation-field:
      name: alert_s8_recommendation
      positive-value: ACTION_POTENTIAL_TRUE_POSITIVE
      negative-value: ACTION_FALSE_POSITIVE
    analyst-decision-field:
      name: alert_analyst_decision
      positive-value: analyst_decision_true_positive
      negative-value: analyst_decision_false_positive
    qa-decision-field:
      name: alert_qa.level-0.state
      positive-value: qa_decision_PASSED
      negative-value: qa_decision_FAILED

  simulation:
    date-field:
      name: index_timestamp
      label: Date
      source-pattern: yyyy-MM-dd HH:mm:ss
      target-pattern: yyyy-MM
    risk-type:
      name: alert_extendedAttribute5
      label: Risk Type
    hit-type:
      name: alert_categories/hitType
      label: Hit Type
    country:
      name: s8_country
      label: Country
    recommendation-field:
      name: alert_recommendation_recommended_action
      positive-value: ACTION_POTENTIAL_TRUE_POSITIVE
      negative-value: ACTION_FALSE_POSITIVE
    analyst-decision-field:
      name: alert_analyst_decision
      positive-value: analyst_decision_true_positive
      negative-value: analyst_decision_false_positive
    qa-decision-field:
      name: alert_qa.level-0.state
      positive-value: qa_decision_PASSED
      negative-value: qa_decision_FAILED

warehouse.report.statistics:
  date-field-name: index_timestamp
  ai-decision:
    field: alert_recommendation_recommended_action
    significant-values: [ACTION_FALSE_POSITIVE, ACTION_POTENTIAL_TRUE_POSITIVE]
    false-positive-value: ACTION_FALSE_POSITIVE
  analyst-decision:
    field: alert_firco_analyst_decision
    false-positive-value: analyst_decision_false_positive

warehouse.report.accuracy:
  production:
    date-field-name: alert_create_time
    columns:
      - name: alert_recommended_action
        label: S8 Alert Resolution
      - name: alert_create_time
        label: S8 Alert Resolution Timestamp
      - name: alert_recommendation_comment
        label: Alert Comment
      - name: alert_firco_analyst_decision
        label: Analyst Decision
      - name: alert_firco_analyst_decision_time
        label: Analyst Decision Timestamp
      - name: alert_firco_analyst_comment
        label: Analyst Comment
      - name: alert_firco_system_id
        label: Alert Client ID
      - name: alert_status
        label: Alert Status
      - name: s8_alert_name
        label: Alert S8 ID
    filters:
      - name: alert_firco_analyst_decision
        allowed-values:
          - analyst_decision_false_positive
          - analyst_decision_true_positive
  simulation:
    date-field-name: index_timestamp
    columns:
      - name: alert_match_reason:policy
        label: Policy ID
      - name: alert_match_reason:policy_title
        label: Policy Name
      - name: alert_recommendation_recommended_action
        label: S8 Alert Resolution
      - name: alert_recommendation_create_time
        label: S8 Alert Resolution Timestamp
      - name: alert_recommendation_comment
        label: Alert Comment
      - name: alert_firco_analyst_decision
        label: Analyst Decision
      - name: alert_firco_analyst_decision_time
        label: Analyst Decision Timestamp
      - name: alert_firco_analyst_comment
        label: Analyst Comment
      - name: alert_firco_system_id
        label: Alert Client ID
      - name: alert_status
        label: Alert Status
      - name: s8_alert_name
        label: Alert S8 ID
    filters:
      - name: alert_firco_analyst_decision
        allowed-values:
          - analyst_decision_false_positive
          - analyst_decision_true_positive

warehouse.report.ai-reasoning:
  production:
    date-field-name: alert_create_time
    columns:
      - name: alert_recommended_action
        label: S8 Alert Resolution
      - name: alert_create_time
        label: S8 Alert Resolution Timestamp
      - name: alert_recommendation_comment
        label: Alert Comment
      - name: alert_firco_system_id
        label: Alert Client ID
      - name: alert_status
        label: Alert Status
      - name: alert_alert_message_id
        label: Alert S8 ID
  simulation:
    date-field-name: index_timestamp
    columns:
      - name: alert_match_reason:policy
        label: Policy ID
      - name: alert_match_reason:policy_title
        label: Policy Name
      - name: alert_match_reason:step
        label: Step ID
      - name: alert_match_reason:step_title
        label: Step Name
      - name: alert_match_reason:feature_vector_signature
        label: Reasoning Branch ID
      - name: alert_recommendation_recommended_action
        label: S8 Alert Resolution
      - name: alert_recommendation_create_time
        label: S8 Alert Resolution Timestamp
      - name: alert_recommendation_comment
        label: Alert Comment
      - name: alert_firco_system_id
        label: Alert Client ID
      - name: s8_alert_name
        label: Alert S8 ID

warehouse.report.ai-reasoning-match-level:
  production:
    date-field-name: alert_create_time
    columns:
      - name: match_feature_vector_signature
        label: Reasoning Branch ID
      - name: match_policy
        label: Policy ID
      - name: match_policy_title
        label: Policy Name
      - name: match_step
        label: Step ID
      - name: match_step_title
        label: Step Name
      - name: match_solution
        label: S8 Match Resolution
      - name: alert_recommended_action
        label: S8 Alert Resolution
      - name: alert_recommendation_comment
        label: S8 Alert Comment
      - name: alert_create_time
        label: S8 Alert Resolution timestamp (UTC)
      - name: alert_firco_system_id
        label: Alert Client ID
      - name: s8_alert_name
        label: Alert S8 ID
      - name: alert_status
        label: Alert Status
      - name: alert_delivery_status
        label: Alert Delivery Status
      - name: s8_match_name
        label: Match S8 ID

warehouse.report.deprecated-simulation:
  hidden-types: [METRICS]
