#---------------------------------------------------------------------------------------------------
# SERVER
#---------------------------------------------------------------------------------------------------

server:
  forward-headers-strategy: native
  undertow:
    threads:
      io: 4
      worker: 16

  servlet:
    context-path: /rest/${spring.application.name}

  error:
    include-exception: true
    include-stacktrace: never

#---------------------------------------------------------------------------------------------------
# MANAGEMENT
#---------------------------------------------------------------------------------------------------

management:
  endpoint:
    health.show-details: always

  endpoints:
    web:
      base-path: /management
      exposure:
        include: [ "health", "info", "metrics", "prometheus", "loggers" ]
    # loggers endpoint is secured with mTLS
    loggers:
      sensitive: false

  metrics:
    tags:
      application: ${spring.application.name}

warehouse:
  messaging:
    concurrency: 4
    prefetch: 25

spring:
  #-------------------------------------------------------------------------------------------------
  # GENERAL
  #-------------------------------------------------------------------------------------------------
  aop:
    auto: false

  task:
    execution:
      pool:
        core-size: 8
        keep-alive: 10s
        max-size: 16
        queue-capacity: 10000
      thread-name-prefix: pool-task-

    scheduling:
      pool:
        size: 2
      thread-name-prefix: pool-scheduling-

  main:
    banner-mode: 'off'

  #-------------------------------------------------------------------------------------------------
  # MESSAGING
  #-------------------------------------------------------------------------------------------------
  rabbitmq:
    ssl:
      enabled: false
    listener:
      type: simple
      direct:
        consumers-per-queue: ${warehouse.messaging.concurrency}
        prefetch: ${warehouse.messaging.prefetch}
      simple:
        concurrency: 1
        max-concurrency: ${warehouse.messaging.concurrency}
        prefetch: ${warehouse.messaging.prefetch}

#---------------------------------------------------------------------------------------------------
# SEP BASE CONFIGURATION
#---------------------------------------------------------------------------------------------------

serp:
  show-env: true

  messaging:
    error-queue:
      enabled: true


#-------------------------------------------------------------------------------------------------
# REST API AUTH
#-------------------------------------------------------------------------------------------------

sep:
  auth:
    permissionMethodsMappings:
      REPORTS_MANAGEMENT:
        - "GENERATE_REPORT"

    rolePermissionsMappings:
      BUSINESS_OPERATOR:
        - "REPORTS_MANAGEMENT"
