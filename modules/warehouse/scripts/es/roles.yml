_meta:
  type: "roles"
  config_version: 2

# Restrict users so they can only view visualization and dashboard on kibana
kibana_read_only:
  reserved: true

# The security REST API access role is used to assign specific users access to change the security settings through the REST API.
security_rest_api_access:
  reserved: true

# Allows users to all Reports functionality
reports_full_access:
  reserved: true
  cluster_permissions:
    - 'cluster:admin/opendistro/reports/definition/create'
    - 'cluster:admin/opendistro/reports/definition/update'
    - 'cluster:admin/opendistro/reports/definition/on_demand'
    - 'cluster:admin/opendistro/reports/definition/delete'
    - 'cluster:admin/opendistro/reports/definition/get'
    - 'cluster:admin/opendistro/reports/definition/list'
    - 'cluster:admin/opendistro/reports/instance/list'
    - 'cluster:admin/opendistro/reports/instance/get'
    - 'cluster:admin/opendistro/reports/menu/download'

technical_user:
  reserved: false
  cluster_permissions:
    - 'cluster:admin/opendistro/reports/definition/list'
    - 'cluster:admin/opendistro/reports/instance/list'
    - 'cluster:admin/opendistro/reports/instance/get'
    - 'cluster:admin/opendistro/reports/definition/on_demand'
    - 'cluster:monitor/health'
#  https://discuss.opendistrocommunity.dev/t/cluster-permission-indices-data-write-bulk-needed-for-adding-data-implications/2237/2
    - 'indices:data/write/bulk'
    - 'indices:data/read/search'
    - 'indices:data/read/mget'
    - 'cluster:admin/opendistro/reports/definition/create'
    - 'indices:data/read/scroll/clear'
  index_permissions:
    - index_patterns:
        - 'itest_production'
        - 'itest_simulation_*'
        - 'local_production'
        - 'local_simulation_*'
      allowed_actions:
        - 'indices:data/read/get'
        - 'indices:data/read/search'
        - 'indices:data/write/index'
        - 'indices:data/write/update'
        - 'indices:data/write/bulk'
        - 'indices:data/write/bulk*'
        - 'indices:monitor/settings/get'
        - 'indices:admin/create'
        - 'indices:admin/mapping/put'
        - 'indices:admin/mappings/fields/get'
  tenant_permissions:
    - tenant_patterns:
        - 'itest_*'
        - 'local_*'
      allowed_actions:
        - 'kibana_all_write'

business_user:
  reserved: false
  cluster_permissions:
    - 'cluster:admin/opendistro/reports/instance/get'
    - 'cluster:admin/opendistro/reports/instance/list'
    - 'indices:monitor/settings/get'
    - 'indices:data/read/scroll/clear'
  index_permissions:
    - index_patterns:
        - 'itest_production'
        - 'itest_simulation_*'
        - 'local_production'
        - 'local_simulation_*'
      allowed_actions:
        - 'indices:data/read/get'
        - 'indices:data/read/search'
        - 'indices:monitor/settings/get'
      dls: '{"terms": {"s8_country.keyword": [],"boost": 1}}'
  tenant_permissions:
    - tenant_patterns:
        - 'itest_*'
        - 'local_*'
      allowed_actions:
        - 'kibana_all_read'

technical_user_testsetup:
  reserved: false
  cluster_permissions:
    - 'cluster:admin/opendistro/reports/definition/create'
    - 'cluster:admin/opendistro/reports/definition/delete'
  index_permissions:
    - index_patterns:
        - 'itest_production'
        - 'itest_simulation_*'
        - 'local_production'
        - 'local_simulation_*'
      allowed_actions:
        - 'indices:admin/delete'
  tenant_permissions:
    - tenant_patterns:
        - 'itest_*'
        - 'local_*'
      allowed_actions:
        - 'kibana_all_write'

8326aa5a-cffc-4bc5-9f7f-9a4d94db616a:
  reserved: false
  index_permissions:
    - index_patterns:
        - 'itest_production'
        - 'itest_simulation_*'
        - 'local_production'
        - 'local_simulation_*'
      dls: '{"terms": {"s8_country.keyword": ["UK","PL"],"boost": 1}}'
