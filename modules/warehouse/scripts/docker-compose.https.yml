version: '3'

services:
  odfe-node1:
    environment:
      - opendistro_security.ssl.http.enabled=true
  odfe-node2:
    environment:
      - opendistro_security.ssl.http.enabled=true
  kibana:
    environment:
      ELASTICSEARCH_URL: https://odfe-node1:9200
      ELASTICSEARCH_HOSTS: https://odfe-node1:9200
  minio:
    volumes:
      - ./minio/private.key:/root/.minio/certs/private.key:ro
      - ./minio/public.crt:/root/.minio/certs/public.crt:ro
  createbuckets:
    entrypoint: >
      /bin/sh -c "
      /usr/bin/mc config host add --insecure myminio https://minio:9000 admin admin123;
      /usr/bin/mc mb --ignore-existing --insecure myminio/reports;
      exit 0;
      "
