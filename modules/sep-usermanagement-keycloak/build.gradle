plugins {
  id "idea"
  id "java-library"
  id "maven-publish"
  id "com.silenteight.gradle.wrapper" version "1.0.25"
  id "com.silenteight.gradle.release" version "1.0.9"
  id "com.silenteight.gradle.convention" version "1.14.0"
  id "org.sonarqube" version "2.8"
}

projectSetup {
  javaVersion = JavaVersion.VERSION_11
}

sourceCompatibility = 1.11
targetCompatibility = 1.11

ext {
  libraries = [:]
  springBootVersion = "2.3.1.RELEASE"
  silenteightSepBaseVersion = "1.5.0"
  silenteightSepUsermanagementApiVersion = "1.3.0"
  keycloakVersion = '8.0.1'
}

repositories {
  mavenCentral()
}
libraries.silenteight_sep_base_common =
    [group: 'com.silenteight.sep.base', name: 'sep-base-common', version: silenteightSepBaseVersion]
libraries.silenteight_sep_base_testing =
    [group: 'com.silenteight.sep.base', name: 'sep-base-testing', version: silenteightSepBaseVersion]
libraries.silenteight_sep_usermanagement_api =
    [group: 'com.silenteight.sep.usermanagement', name: 'sep-usermanagement-api', version:
        silenteightSepUsermanagementApiVersion]

libraries.platform_spring_boot =
    [group: 'org.springframework.boot', name: 'spring-boot-dependencies', version: springBootVersion]
libraries.spring_context = [group: 'org.springframework', name: 'spring-context']

// Keycloak
libraries.keycloak_bom = [group: 'org.keycloak.bom', name: 'keycloak-adapter-bom', version:
    keycloakVersion]
libraries.keycloak_admin_client =
    [group: 'org.keycloak', name: 'keycloak-admin-client', version: keycloakVersion]

libraries.assertj_core = [group: 'org.assertj', name: 'assertj-core']
libraries.caffeine = [group: 'com.github.ben-manes.caffeine', name: 'caffeine']
libraries.streamex = [group: "one.util", name: "streamex", version: "0.7.2"]

dependencies {
  api(libraries.silenteight_sep_base_common) {
    exclude group: 'org.springframework.amqp', module: '*'
    exclude group: 'org.springframework.integration', module: '*'
    exclude group: 'com.rabbitmq', module: '*'
    exclude group: 'jakarta.servlet', module: '*'
    exclude group: 'org.hibernate', module: '*'
    exclude group: 'jakarta.persistence', module: '*'
    exclude group: 'com.google.protobuf', module: '*'
  }

  implementation libraries.silenteight_sep_usermanagement_api
  implementation platform(libraries.platform_spring_boot)
  implementation libraries.keycloak_admin_client
  implementation libraries.caffeine
  implementation libraries.streamex

  testImplementation(libraries.silenteight_sep_base_testing) {
    exclude group: 'org.testcontainers', module: '*'
    exclude group: 'io.grpc', module: '*'
  }
  testImplementation libraries.assertj_core

  api libraries.spring_context
}
